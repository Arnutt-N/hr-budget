# Database Schema Analysis - Budget Expense Structure

## ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

### ‚úÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

| Table | Purpose | Hierarchy |
|-------|---------|-----------|
| `budget_plans` | ‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô/‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï/‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° | parent_id (4 levels) |
| `budget_categories` | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ (‡∏á‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£, ‡∏á‡∏ö‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô, etc.) | parent_id |
| `budget_category_items` | ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | category_id (flat) |
| `fund_sources` | ‡πÅ‡∏´‡∏•‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô 5 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | parent_id |
| `budget_allocations` | ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° plan + category + item + budget amounts | - |

### ‚ùå ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:** ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏°‡∏µ 6 ‡∏£‡∏∞‡∏î‡∏±‡∏ö (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 0-5) ‡πÅ‡∏ï‡πà‡∏ï‡∏≤‡∏£‡∏≤‡∏á `budget_category_items` ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö Flat ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö hierarchy

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á:**
```
‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 0: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥
‚îî‚îÄ‚îÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 1: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
    ‚îî‚îÄ‚îÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 2: ‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
        ‚îî‚îÄ‚îÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 3: ‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
            ‚îî‚îÄ‚îÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 4: ‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡πÄ‡∏â‡∏û‡∏≤‡∏∞
                ‚îî‚îÄ‚îÄ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 5: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå
```

### üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

**Option A: ‡πÄ‡∏û‡∏¥‡πà‡∏° parent_id ‡πÉ‡∏´‡πâ budget_category_items**
```sql
ALTER TABLE budget_category_items 
ADD COLUMN parent_id INT NULL COMMENT 'FK: parent item',
ADD COLUMN level INT NOT NULL DEFAULT 0 COMMENT '‡∏£‡∏∞‡∏î‡∏±‡∏ö 0-5',
ADD INDEX idx_parent_id (parent_id);
```

**Option B: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á budget_expense_items ‡πÉ‡∏´‡∏°‡πà**
- ‡∏£‡∏ß‡∏° expense type + items ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
- ‡πÉ‡∏ä‡πâ parent_id ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô budget_categories

### üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

- ‚úÖ `budget_plans` ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô/‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï/‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
- ‚úÖ `budget_categories` ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ 5 ‡∏´‡∏°‡∏ß‡∏î
- ‚ùì `budget_category_items` ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° parent_id ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 6 ‡∏£‡∏∞‡∏î‡∏±‡∏ö
- ‚úÖ `budget_allocations` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### üîó Reference Files
- [budget_structure_reference.csv](./budget_structure_reference.csv) - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á
- [wireframe_disbursement_form.html](./wireframe_disbursement_form.html) - Wireframe UI
